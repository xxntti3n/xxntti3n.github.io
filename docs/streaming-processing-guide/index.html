<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>End-to-End Streaming Processing: MySQL CDC → Flink → Iceberg → Trino | xxntti3n</title>
  <meta name="description" content="A production-style streaming framework: read CDC from MySQL, join and aggregate two tables in Flink, write one result table to Iceberg, query with Trino, and chart with Superset.">
  <meta name="author" content="Tien Nguyen">

  <!-- Open Graph -->
  <meta property="og:title" content="End-to-End Streaming Processing: MySQL CDC → Flink → Iceberg → Trino">
  <meta property="og:description" content="A production-style streaming framework: read CDC from MySQL, join and aggregate two tables in Flink, write one result table to Iceberg, query with Trino, and chart with Superset.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://xxntti3n.github.io/streaming-processing-guide/">
  <meta property="og:image" content="https://xxntti3n.github.io/assets/og-default.png">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- RSS Feed -->
  <link rel="alternate" type="application/atom+xml" title="xxntti3n" href="/feed.xml">
  <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon.png">

  <!-- Prism for syntax highlighting -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

  <style>
    :root {
      /* Background Colors */
      --bg-primary: #fafafa;
      --bg-secondary: #ffffff;
      --bg-tertiary: #f5f7f9;

      /* Text Colors */
      --text-primary: #0d1117;
      --text-secondary: #3b4252;
      --text-tertiary: #6e7681;

      /* Accent Colors */
      --accent: #FF6719;
      --accent-hover: #e55a15;

      /* Border Colors */
      --border: #e5e9ef;
      --border-light: #f0f3f6;

      /* Code Block */
      --code-bg: #1e1e1e;
      --quote-bg: #fffbf0;
      --quote-border: #FF6719;

      /* Link Colors */
      --link-color: #0969da;
      --link-hover: #FF6719;

      /* Shadows */
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);

      /* Gradients */
      --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #FF6719 100%);
      --gradient-warm: linear-gradient(135deg, #FF6719 0%, #ff8c42 100%);

      /* Typography */
      --font-serif: 'Spectral', Georgia, 'Times New Roman', serif;
      --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      --font-mono: 'SF Mono', 'Monaco', 'Menlo', 'Consolas', monospace;

      /* Spacing */
      --max-width: 1200px;
      --content-width: 700px;

      /* Border Radius */
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
    }

    /* Dark Theme */
    .dark-theme {
      --bg-primary: #0d1117;
      --bg-secondary: #161b22;
      --bg-tertiary: #21262d;

      --text-primary: #f0f6fc;
      --text-secondary: #8b949e;
      --text-tertiary: #6e7681;

      --border: rgba(255, 255, 255, 0.1);
      --border-light: rgba(255, 255, 255, 0.05);

      --shadow-sm: 0 1px 3px rgba(0,0,0,0.3);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
      --shadow-lg: 0 8px 24px rgba(0,0,0,0.5);

      --quote-bg: rgba(255, 103, 25, 0.1);
      --link-color: #58a6ff;
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: var(--font-serif);
      line-height: 1.7;
      color: var(--text-primary);
      background: var(--bg-primary);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
      transition: background-color 0.3s ease, color 0.3s ease;
    }

    ::selection {
      background: rgba(255, 103, 25, 0.2);
      color: var(--text-primary);
    }

    .page-wrapper {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 24px;
      width: 100%;
    }

    .content-wrapper {
      max-width: var(--content-width);
      margin: 0 auto;
    }

    /* Progress Bar */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 3px;
      background: var(--gradient-hero);
      width: 0%;
      z-index: 1000;
      transition: width 0.15s ease-out;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
    }

    /* Back to top */
    .back-to-top {
      position: fixed;
      bottom: 32px;
      right: 32px;
      width: 44px;
      height: 44px;
      background: var(--gradient-hero);
      color: white;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      opacity: 0;
      visibility: hidden;
      transform: translateY(10px);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
    }

    .back-to-top.visible {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .back-to-top:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .back-to-top svg {
      width: 20px;
      height: 20px;
    }

    /* Breadcrumbs - compact */
    .breadcrumbs {
      padding: 12px 0;
      font-family: var(--font-sans);
      font-size: 13px;
    }

    .breadcrumbs a {
      color: var(--text-secondary);
      text-decoration: none;
      transition: color 0.2s ease;
    }

    .dark-theme .breadcrumbs a {
      color: #8b949e;
    }

    .breadcrumbs a:hover {
      color: var(--accent);
    }

    .breadcrumbs span {
      color: var(--text-tertiary);
      margin: 0 8px;
    }

    .breadcrumbs .current {
      color: var(--text-tertiary);
    }

    .article-back-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: var(--font-sans);
      font-size: 13px;
      color: var(--text-tertiary);
      text-decoration: none;
      margin-bottom: 16px;
      transition: color 0.2s ease;
    }

    .article-back-link:hover {
      color: var(--accent);
    }

    /* Article Layout - cleaner, less stuffed */
    .article-layout {
      display: grid;
      grid-template-columns: 220px 1fr;
      gap: 40px;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
      padding: 24px 24px 48px;
    }

    @media (max-width: 1024px) {
      .article-layout {
        grid-template-columns: 1fr;
        gap: 24px;
        padding: 20px 20px 40px;
      }
    }

    /* Article Header - compact */
    .article-header {
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
      margin-bottom: 28px;
    }

    .article-title {
      font-family: var(--font-serif);
      font-size: clamp(26px, 3.5vw, 38px);
      font-weight: 700;
      line-height: 1.25;
      margin: 0 0 12px;
      color: var(--text-primary);
    }

    .article-subtitle {
      font-family: var(--font-serif);
      font-size: 17px;
      line-height: 1.5;
      color: var(--text-secondary);
      margin: 0 0 20px 0;
    }

    .article-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 12px 24px;
      align-items: center;
    }

    .article-author {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .article-author-avatar {
      width: 36px;
      height: 36px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-primary);
      font-family: var(--font-sans);
      font-weight: 700;
      font-size: 14px;
    }

    .article-author-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .article-author-name {
      font-family: var(--font-sans);
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .article-date {
      font-family: var(--font-sans);
      font-size: 13px;
      color: var(--text-tertiary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .article-reading-time {
      font-family: var(--font-sans);
      font-size: 13px;
      color: var(--text-tertiary);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Article Content */
    .article-content {
      font-family: var(--font-serif);
      font-size: 17px;
      line-height: 1.75;
      color: var(--text-primary);
    }

    .article-content h1 {
      font-family: var(--font-serif);
      font-size: 32px;
      font-weight: 700;
      margin: 32px 0 20px;
      padding-bottom: 12px;
    }

    .article-content h2 {
      font-family: var(--font-serif);
      font-size: 26px;
      font-weight: 600;
      margin: 28px 0 16px;
      padding-bottom: 8px;
      scroll-margin-top: 80px;
    }

    .article-content h3 {
      font-family: var(--font-serif);
      font-size: 22px;
      font-weight: 600;
      margin: 24px 0 12px;
      scroll-margin-top: 80px;
    }

    .article-content h4 {
      font-family: var(--font-serif);
      font-size: 18px;
      font-weight: 600;
      margin: 20px 0 12px;
    }

    .article-content p {
      margin-bottom: 16px;
    }

    .article-content ul, .article-content ol {
      margin: 16px 0;
      padding-left: 24px;
      line-height: 1.8;
    }

    .article-content li {
      margin-bottom: 8px;
    }

    .article-content a {
      color: var(--link-color);
      text-decoration: none;
      border-bottom: 1px solid transparent;
      transition: border-color 0.2s ease;
    }

    .article-content a:hover {
      border-bottom-color: var(--link-hover);
    }

    /* Code Blocks */
    .article-content pre {
      background: var(--code-bg);
      border-radius: var(--radius-md);
      padding: 16px;
      margin: 20px 0;
      overflow-x: auto;
      max-width: 100%;
      font-size: 13px;
      line-height: 1.5;
    }

    .article-content pre code {
      font-size: inherit;
      background: transparent;
      padding: 0;
    }

    .article-content code {
      font-family: var(--font-mono);
      font-size: 14px;
      background: var(--bg-tertiary);
      padding: 3px 6px;
      border-radius: 4px;
    }

    .dark-theme .article-content code {
      background: rgba(255, 255, 255, 0.1);
    }

    /* Blockquote */
    .article-content blockquote {
      background: var(--quote-bg);
      border-left: 4px solid var(--quote-border);
      padding: 16px 20px;
      margin: 20px 0;
      border-radius: var(--radius-sm);
    }

    .article-content blockquote strong {
      color: var(--text-primary);
    }

    /* Inline Code */
    .article-content p code,
    .article-content li code {
      background: var(--bg-tertiary);
      color: var(--accent);
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 0.9em;
    }

    .dark-theme .article-content p code,
    .dark-theme .article-content li code {
      background: rgba(255, 255, 255, 0.1);
    }

    /* Diagrams */
    .article-content pre.mermaid {
      background: transparent;
      padding: 0;
      text-align: center;
    }

    /* TOC Sidebar - slimmer */
    .toc-sidebar {
      position: sticky;
      top: 88px;
      height: fit-content;
      align-self: start;
    }

    @media (max-width: 1024px) {
      .toc-sidebar {
        position: static;
        margin-bottom: 24px;
        padding-bottom: 24px;
        border-bottom: 1px solid var(--border);
      }
    }

    .toc-title {
      font-family: var(--font-sans);
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--text-tertiary);
      margin: 0 0 16px;
    }

    .toc-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .toc-list li {
      margin-bottom: 6px;
    }

    .toc-list a {
      font-family: var(--font-sans);
      font-size: 13px;
      color: var(--text-secondary);
      text-decoration: none;
      display: block;
      padding: 8px 12px;
      border-radius: var(--radius-sm);
      transition: all 0.2s ease;
      border-left: 3px solid transparent;
    }

    .dark-theme .toc-list a {
      color: #8b949e;
    }

    .toc-list a:hover,
    .toc-list a.active {
      background: var(--bg-tertiary);
      color: var(--text-primary);
      border-left-color: var(--accent);
    }

    .dark-theme .toc-list a:hover,
    .dark-theme .toc-list a.active {
      background: rgba(255, 255, 255, 0.05);
    }

    /* Author Bio - compact */
    .author-bio {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-light);
      border-radius: var(--radius-sm);
      padding: 16px 20px;
      margin: 32px 0 24px;
    }

    .dark-theme .author-bio {
      background: rgba(255, 255, 255, 0.04);
      border-color: rgba(255, 255, 255, 0.08);
    }

    .author-bio h3 {
      font-family: var(--font-sans);
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      margin: 0 0 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .author-bio p {
      font-family: var(--font-serif);
      font-size: 14px;
      line-height: 1.6;
      color: var(--text-secondary);
      margin: 0;
    }

    /* Subscribe Box - neutral, no color theme */
    .subscribe-box {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: 24px;
      margin: 32px 0;
      text-align: center;
    }

    .dark-theme .subscribe-box {
      background: var(--bg-tertiary);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .subscribe-title {
      font-family: var(--font-serif);
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin: 0 0 8px;
    }

    .subscribe-box-text {
      font-family: var(--font-serif);
      font-size: 14px;
      color: var(--text-secondary);
      margin: 0 0 16px;
    }

    .subscribe-form {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      max-width: 360px;
      margin: 0 auto;
    }

    .subscribe-input {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-size: 15px;
      font-family: var(--font-sans);
      background: var(--bg-primary);
      color: var(--text-primary);
    }

    .subscribe-input:focus {
      outline: none;
      border-color: var(--accent);
    }

    .subscribe-btn {
      padding: 12px 24px;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: var(--radius-sm);
      font-size: 15px;
      font-weight: 600;
      font-family: var(--font-sans);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .subscribe-btn:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-sm);
    }

    .subscribe-terms {
      font-family: var(--font-sans);
      font-size: 11px;
      color: var(--text-tertiary);
      margin-top: 10px;
    }

    /* Share Buttons */
    .share-section {
      margin: 24px 0;
      padding-top: 20px;
      border-top: 1px solid var(--border);
    }

    .share-title {
      font-family: var(--font-sans);
      font-size: 13px;
      font-weight: 600;
      color: var(--text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 0 0 16px;
    }

    .share-buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .share-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      font-family: var(--font-sans);
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.2s ease;
    }

    .dark-theme .share-btn {
      background: rgba(255, 255, 255, 0.05);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .share-btn:hover {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .share-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .article-layout {
        padding: 20px 16px 40px;
      }

      .article-title {
        font-size: 28px;
      }

      .article-subtitle {
        font-size: 16px;
      }

      .article-content h1 {
        font-size: 28px;
        margin: 24px 0 16px;
      }

      .article-content h2 {
        font-size: 22px;
        margin: 20px 0 16px;
      }

      .back-to-top {
        bottom: 20px;
        right: 20px;
        width: 40px;
        height: 40px;
      }
    }
  </style>
</head>
<body>
  <div class="progress-bar" id="progressBar"></div>

  <div class="page-wrapper">
    <header class="site-header" id="siteHeader">
  <div class="site-header-content">
    <a href="/" class="site-logo">
      <img src="/assets/images/logo-writing-book.svg" alt="" class="site-logo-icon" width="36" height="36">
      <span class="site-logo-text">xxntti3n</span>
    </a>

    <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle menu">
      <span class="hamburger"></span>
      <span class="hamburger"></span>
      <span class="hamburger"></span>
    </button>

    <nav class="site-nav" id="siteNav">
      <a href="/" class="nav-link">Home</a>
      <a href="/kubernetes/" class="nav-link">Kubernetes</a>
      <a href="/iceberg/" class="nav-link">Iceberg</a>
      <a href="/about/" class="nav-link">About</a>
      <a href="https://github.com/xxntti3n" target="_blank" rel="noopener" class="nav-link nav-link--external">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.236 3.221-1.236 4.608 0 2.807 1.803 5.626 5.469 5.921-.43.372-.823 1.102-.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        GitHub
      </a>

      <!-- Dark mode toggle -->
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
        <svg class="theme-icon sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/>
          <line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
          <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/>
          <line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
          <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <svg class="theme-icon moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
      </button>
    </nav>
  </div>

  <script>
    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const siteNav = document.getElementById('siteNav');
    const siteHeader = document.getElementById('siteHeader');

    mobileMenuToggle.addEventListener('click', () => {
      mobileMenuToggle.classList.toggle('active');
      siteNav.classList.toggle('active');
      document.body.style.overflow = siteNav.classList.contains('active') ? 'hidden' : '';
    });

    // Close menu when clicking a link
    document.querySelectorAll('.site-nav a').forEach(link => {
      link.addEventListener('click', () => {
        mobileMenuToggle.classList.remove('active');
        siteNav.classList.remove('active');
        document.body.style.overflow = '';
      });
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!siteHeader.contains(e.target) && siteNav.classList.contains('active')) {
        mobileMenuToggle.classList.remove('active');
        siteNav.classList.remove('active');
        document.body.style.overflow = '';
      }
    });

    // Dark mode toggle
    const themeToggle = document.getElementById('themeToggle');
    const sunIcon = themeToggle.querySelector('.sun');
    const moonIcon = themeToggle.querySelector('.moon');

    // Check for saved theme; default to light for consistent UI
    const savedTheme = localStorage.getItem('theme');
    const currentTheme = savedTheme || 'light';

    if (currentTheme === 'dark') {
      document.documentElement.classList.add('dark-theme');
      sunIcon.style.display = 'none';
      moonIcon.style.display = 'block';
    }

    themeToggle.addEventListener('click', () => {
      const isDark = document.documentElement.classList.toggle('dark-theme');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
      sunIcon.style.display = isDark ? 'none' : 'block';
      moonIcon.style.display = isDark ? 'block' : 'none';
    });
  </script>
</header>

<style>
  .site-header {
    position: sticky;
    top: 0;
    z-index: 100;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-light);
    transition: all 0.2s ease;
  }

  .dark-theme .site-header {
    background: rgba(13, 17, 23, 0.95);
    border-bottom-color: rgba(255, 255, 255, 0.1);
  }

  .site-header-content {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 0 24px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 64px;
  }

  .site-logo {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
  }

  .site-logo-icon {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: block;
    object-fit: contain;
    /* Logo is black; invert in dark theme so it stays visible */
  }

  .dark-theme .site-logo-icon {
    filter: invert(1) brightness(1.1);
  }

  .site-logo-text {
    font-family: var(--font-sans);
    font-weight: 700;
    font-size: 16px;
    color: var(--text-primary);
  }

  .dark-theme .site-logo-text {
    color: #f0f6fc;
  }

  .mobile-menu-toggle {
    display: none;
    flex-direction: column;
    gap: 5px;
    background: none;
    border: none;
    cursor: pointer;
    padding: 8px;
    z-index: 101;
  }

  .mobile-menu-toggle .hamburger {
    width: 24px;
    height: 2px;
    background: var(--text-primary);
    border-radius: 2px;
    transition: all 0.3s ease;
  }

  .dark-theme .mobile-menu-toggle .hamburger {
    background: #f0f6fc;
  }

  .mobile-menu-toggle.active .hamburger:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }

  .mobile-menu-toggle.active .hamburger:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-toggle.active .hamburger:nth-child(3) {
    transform: rotate(-45deg) translate(5px, -5px);
  }

  .site-nav {
    display: flex;
    align-items: center;
    gap: 24px;
  }

  .site-nav .nav-link {
    font-family: var(--font-sans);
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .dark-theme .site-nav .nav-link {
    color: #8b949e;
  }

  .site-nav .nav-link:hover {
    color: var(--accent);
  }

  .site-nav .nav-link--external {
    opacity: 0.8;
  }

  .theme-toggle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: var(--bg-tertiary);
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--text-secondary);
  }

  .dark-theme .theme-toggle {
    background: rgba(255, 255, 255, 0.1);
    color: #f0f6fc;
  }

  .theme-toggle:hover {
    background: var(--accent);
    color: white;
  }

  @media (max-width: 768px) {
    .mobile-menu-toggle {
      display: flex;
    }

    .site-nav {
      position: fixed;
      top: 64px;
      left: 0;
      right: 0;
      flex-direction: column;
      gap: 0;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border);
      padding: 16px 24px;
      transform: translateY(-100%);
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      max-height: calc(100vh - 64px);
      overflow-y: auto;
    }

    .dark-theme .site-nav {
      background: #0d1117;
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }

    .site-nav.active {
      transform: translateY(0);
      opacity: 1;
      visibility: visible;
    }

    .site-nav .nav-link {
      padding: 14px 0;
      font-size: 16px;
      border-bottom: 1px solid var(--border-light);
    }

    .dark-theme .site-nav .nav-link {
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }

    .site-nav .nav-link:last-child {
      border-bottom: none;
    }

    .theme-toggle {
      margin-top: 16px;
      width: 100%;
      height: 44px;
    }
  }
</style>


    <div class="container" style="padding-top: 20px;">
      
      <nav class="breadcrumbs" aria-label="Breadcrumb" style="padding-bottom: 8px;">
        <a href="/">Home</a>
        <span>/</span>
        
        <span class="current">End-to-End Streaming Processing: MySQL CDC → Flink → Iceberg → Trino</span>
      </nav>
    </div>

    <main class="article-layout">
      <!-- TOC Sidebar -->
      

      <!-- Article Content -->
      <article>
        <header class="article-header">
          <h1 class="article-title">End-to-End Streaming Processing: MySQL CDC → Flink → Iceberg → Trino</h1>
          
          <div class="article-meta">
            <div class="article-author">
              <div class="article-author-avatar">TN</div>
              <div class="article-author-info">
                <span class="article-author-name">Tien Nguyen</span>
                <span class="article-date">
                  <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <path d="M16 2v4M12 5l7 7"/>
                  </svg>
                  Feb 14, 2026
                </span>
              </div>
            </div>
            
            <span class="article-reading-time">
              <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12 6 12 12 16 14"/>
              </svg>
              25 min read
            </span>
            
          </div>
        </header>

        <div class="article-content">
          <p>If you’re building a lakehouse or real-time analytics pipeline, you’ve probably juggled CDC, stream processing, and table formats. Getting them to work together—with joins and aggregates on the fly—is where it gets interesting. This guide walks through an end-to-end streaming framework: <strong>MySQL CDC → Apache Flink (join + aggregate) → Apache Iceberg → Trino → Superset</strong>.</p>

<p>You get a single pipeline that reads two source tables, joins them, aggregates by key, and writes one result table to Iceberg. Then you query and chart that table with Trino and Superset. No Kafka in the middle for this setup—Flink reads binlog directly and writes to Iceberg.</p>

<hr />

<h2 id="what-were-building">What We’re Building</h2>

<ul>
  <li><strong>Source</strong>: MySQL with <code class="language-plaintext highlighter-rouge">products</code> and <code class="language-plaintext highlighter-rouge">sales</code>; row-based binlog for CDC.</li>
  <li><strong>Processing</strong>: One Flink SQL job that:
    <ul>
      <li>Reads <code class="language-plaintext highlighter-rouge">products</code> and <code class="language-plaintext highlighter-rouge">sales</code> via MySQL CDC.</li>
      <li>Joins <code class="language-plaintext highlighter-rouge">sales</code> with <code class="language-plaintext highlighter-rouge">products</code> on <code class="language-plaintext highlighter-rouge">product_id</code>.</li>
      <li>Aggregates by product: <code class="language-plaintext highlighter-rouge">total_qty</code>, <code class="language-plaintext highlighter-rouge">total_revenue</code>, <code class="language-plaintext highlighter-rouge">sale_count</code>, <code class="language-plaintext highlighter-rouge">last_sale_ts</code>.</li>
      <li>Writes the result to a single Iceberg table: <code class="language-plaintext highlighter-rouge">demo.sales_by_product</code> (upsert by <code class="language-plaintext highlighter-rouge">product_id</code>).</li>
    </ul>
  </li>
  <li><strong>Storage</strong>: Iceberg catalog in MySQL (JDBC), data in MinIO (S3-compatible).</li>
  <li><strong>Query</strong>: Trino over Iceberg.</li>
  <li><strong>BI</strong>: Superset connected to Trino, charting Iceberg data.</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>┌─────────────┐     ┌──────────────────────────────────────────┐     ┌─────────────┐
│   MySQL     │     │  Flink (CDC → join → aggregate)          │     │   Iceberg   │
│  products   │────▶│  sales ⟗ products → GROUP BY product_id  │────▶│ sales_by_   │
│  sales      │     │  → upsert demo.sales_by_product           │     │ product     │
└─────────────┘     └──────────────────────────────────────────┘     └──────┬──────┘
                                                                              │
       ┌─────────────────────────────────────────────────────────────────────┘
       │
       ▼
┌─────────────┐     ┌─────────────┐
│   Trino     │────▶│  Superset   │
│  (query)    │     │  (charts)    │
└─────────────┘     └─────────────┘
</code></pre></div></div>

<hr />

<h2 id="part-1-architecture">Part 1: Architecture</h2>

<h3 id="components">Components</h3>

<table>
  <thead>
    <tr>
      <th>Component</th>
      <th>Role</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MySQL</strong></td>
      <td>OLTP source; binlog_format=ROW, binlog_row_image=FULL. Databases: <code class="language-plaintext highlighter-rouge">appdb</code> (products, sales), <code class="language-plaintext highlighter-rouge">iceberg_catalog</code> (Iceberg JDBC catalog metadata).</td>
    </tr>
    <tr>
      <td><strong>MinIO</strong></td>
      <td>S3-compatible object store for Iceberg data (warehouse path <code class="language-plaintext highlighter-rouge">s3://iceberg/warehouse</code>).</td>
    </tr>
    <tr>
      <td><strong>Flink</strong></td>
      <td>JobManager + TaskManagers. Runs one streaming job: MySQL CDC sources → join → group aggregate → Iceberg sink (upsert).</td>
    </tr>
    <tr>
      <td><strong>Iceberg</strong></td>
      <td>Table format. Catalog: JDBC (MySQL). Tables created by Flink; Trino and Flink share the same catalog.</td>
    </tr>
    <tr>
      <td><strong>Trino</strong></td>
      <td>SQL engine to query Iceberg tables (e.g. <code class="language-plaintext highlighter-rouge">SELECT * FROM iceberg.demo.sales_by_product</code>).</td>
    </tr>
    <tr>
      <td><strong>Superset</strong></td>
      <td>BI; connects to Trino, uses pre-configured “Trino Iceberg” database to build datasets and charts from Iceberg.</td>
    </tr>
  </tbody>
</table>

<h3 id="data-flow">Data Flow</h3>

<ol>
  <li><strong>CDC</strong>: Flink MySQL CDC connector does initial snapshot then streams binlog events for <code class="language-plaintext highlighter-rouge">products</code> and <code class="language-plaintext highlighter-rouge">sales</code>.</li>
  <li><strong>Join</strong>: Stream–stream join on <code class="language-plaintext highlighter-rouge">sales.product_id = products.id</code>. Both sides are changelog streams.</li>
  <li><strong>Aggregate</strong>: Non-windowed group by <code class="language-plaintext highlighter-rouge">(product_id, product_sku, product_name)</code> with <code class="language-plaintext highlighter-rouge">SUM(qty)</code>, <code class="language-plaintext highlighter-rouge">SUM(qty*price)</code>, <code class="language-plaintext highlighter-rouge">COUNT(*)</code>, <code class="language-plaintext highlighter-rouge">MAX(sale_ts)</code>.</li>
  <li><strong>Sink</strong>: Iceberg table with primary key <code class="language-plaintext highlighter-rouge">product_id</code> and <code class="language-plaintext highlighter-rouge">write.upsert.enabled=true</code>, so each key is updated in place.</li>
  <li><strong>Query</strong>: Trino reads Iceberg via the same JDBC catalog and S3 (MinIO); Superset runs SQL via Trino and renders charts.</li>
</ol>

<hr />

<h2 id="part-2-flink-sql-job">Part 2: Flink SQL Job</h2>

<p>The pipeline is defined in a single Flink SQL file (one statement per line to satisfy the client):</p>

<ul>
  <li><strong>Catalog</strong>: Iceberg JDBC catalog pointing at MySQL and MinIO (S3).</li>
  <li><strong>Temporary tables</strong>: <code class="language-plaintext highlighter-rouge">mysql_products_stream</code>, <code class="language-plaintext highlighter-rouge">mysql_sales_stream</code> (MySQL CDC).</li>
  <li><strong>Iceberg table</strong>: <code class="language-plaintext highlighter-rouge">lake.demo.sales_by_product</code> with format-version 2 and upsert enabled.</li>
  <li><strong>Insert</strong>: Join + aggregate into <code class="language-plaintext highlighter-rouge">lake.demo.sales_by_product</code>.</li>
</ul>

<p>Important details:</p>

<ul>
  <li>No <code class="language-plaintext highlighter-rouge">IF NOT EXISTS</code> in DDL (Flink SQL parser doesn’t support it in this setup).</li>
  <li>Single-line statements so the SQL client submits one statement at a time.</li>
  <li>State TTL and checkpointing configured so the job can run continuously.</li>
</ul>

<hr />

<h2 id="part-3-deployment">Part 3: Deployment</h2>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
  <li>Docker and Docker Compose (or docker-compose).</li>
  <li>Optional: Trino needs the MySQL JDBC JAR for the Iceberg JDBC catalog; the repo can document downloading it into <code class="language-plaintext highlighter-rouge">trino/lib/</code>.</li>
</ul>

<h3 id="commands">Commands</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Build and start all services (MySQL, MinIO, Flink, Trino, Superset, mysql-data-inserter)</span>
docker compose up <span class="nt">-d</span> <span class="nt">--build</span>

<span class="c"># Create MinIO bucket for Iceberg (e.g. iceberg)</span>
docker compose run <span class="nt">--rm</span> mc

<span class="c"># Submit the Flink job (after Flink is up)</span>
./submit-flink-job.sh
</code></pre></div></div>

<h3 id="verification">Verification</h3>

<ul>
  <li><strong>Flink</strong>: http://localhost:8081 — one running job (insert into <code class="language-plaintext highlighter-rouge">lake.demo.sales_by_product</code>).</li>
  <li><strong>Trino</strong>: http://localhost:8080 — run <code class="language-plaintext highlighter-rouge">SELECT * FROM iceberg.demo.sales_by_product</code>.</li>
  <li><strong>Superset</strong>: http://localhost:8088 (admin / admin). Trino Iceberg database is pre-added; add dataset from <code class="language-plaintext highlighter-rouge">demo.sales_by_product</code> and build charts.</li>
</ul>

<p>Scripts like <code class="language-plaintext highlighter-rouge">verify-stack.sh</code> can check containers, MySQL CDC settings, MinIO bucket, Flink job, and Trino visibility of the Iceberg table.</p>

<hr />

<h2 id="part-4-superset-and-trino">Part 4: Superset and Trino</h2>

<ul>
  <li><strong>Trino database in Superset</strong>: Pre-configured at startup with display name <strong>Trino Iceberg</strong> and SQLAlchemy URI <code class="language-plaintext highlighter-rouge">trino://admin@trino:8080/iceberg</code>. No need to add it manually.</li>
  <li><strong>Charts</strong>: In Superset, create a dataset from schema <code class="language-plaintext highlighter-rouge">demo</code>, table <code class="language-plaintext highlighter-rouge">sales_by_product</code>. Then create charts (e.g. bar chart of <code class="language-plaintext highlighter-rouge">total_revenue</code> by <code class="language-plaintext highlighter-rouge">product_sku</code>). Data is live from Iceberg via Trino.</li>
  <li><strong>SQL Lab</strong>: Select database <strong>Trino Iceberg</strong> and run ad-hoc SQL (e.g. <code class="language-plaintext highlighter-rouge">SELECT * FROM demo.sales_by_product</code>).</li>
</ul>

<hr />

<h2 id="part-5-cicd-and-repo-layout">Part 5: CI/CD and Repo Layout</h2>

<p>A minimal CI workflow can:</p>

<ul>
  <li><strong>Validate</strong>: Run <code class="language-plaintext highlighter-rouge">docker compose config</code> (or <code class="language-plaintext highlighter-rouge">docker-compose config</code>) and shell-check scripts like <code class="language-plaintext highlighter-rouge">submit-flink-job.sh</code> and <code class="language-plaintext highlighter-rouge">verify-stack.sh</code>.</li>
  <li><strong>Build</strong>: Build Flink, Superset, and mysql-data-inserter images (no push) to ensure Dockerfiles and context are valid.</li>
</ul>

<p>Redundant files to remove for a clean repo:</p>

<ul>
  <li>Duplicate or one-off scripts (e.g. standalone insert script if the loop script is the one used by the inserter service).</li>
  <li>A second compose file if one main <code class="language-plaintext highlighter-rouge">docker-compose.yml</code> is enough.</li>
</ul>

<hr />

<h2 id="best-practices-summary">Best Practices Summary</h2>

<ol>
  <li><strong>Single pipeline</strong>: One Flink job for CDC + join + aggregate → one Iceberg table keeps the topology simple and avoids multiple writers to the same table.</li>
  <li><strong>Upsert by key</strong>: Iceberg table with primary key and <code class="language-plaintext highlighter-rouge">write.upsert.enabled=true</code> so Flink’s changelog stream updates rows correctly.</li>
  <li><strong>Shared catalog</strong>: Same Iceberg JDBC catalog and warehouse for Flink and Trino so both see the same tables and paths.</li>
  <li><strong>Pre-add Trino in Superset</strong>: Adding the Trino database at startup avoids permission issues and gives users immediate access to Iceberg data.</li>
  <li><strong>Verify end-to-end</strong>: Use a small script to assert containers, CDC, bucket, Flink job, and Trino query so the stack is ready for demos or development.</li>
</ol>

<hr />

<h2 id="putting-it-together">Putting It Together</h2>

<p>This setup is a template for a <strong>streaming lakehouse</strong>: OLTP in MySQL, stream processing in Flink (with join and aggregation), and query/BI on Iceberg via Trino and Superset. You can extend it with more sources, more joins, or different aggregates; the pattern—CDC → Flink → Iceberg → Trino/Superset—stays the same.</p>

<p>For the full code, Docker Compose, Flink SQL job, and scripts, see the <a href="https://github.com/xxntti3n/streaming-processing">streaming-processing</a> repository (or your fork). Run it locally, point Superset at the pre-configured Trino Iceberg database, and start charting.</p>

<hr />

<p><em>This guide describes an end-to-end streaming framework suitable for development and learning. For production, consider managed services (e.g. Flink on K8s or cloud), dedicated catalog and object storage, and proper security and networking.</em></p>

<p>Share this article</p>

        </div>

        <!-- Share Section -->
        <div class="share-section">
          <div class="share-title">Share this article</div>
          <div class="share-buttons">
            <a href="https://twitter.com/intent/tweet?text=End-to-End+Streaming+Processing%3A+MySQL+CDC+%E2%86%92+Flink+%E2%86%92+Iceberg+%E2%86%92+Trino&url=https://xxntti3n.github.io%2Fstreaming-processing-guide%2F" target="_blank" rel="noopener" class="share-btn">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M18.244 2.25h3.308l-2.684 8.016h-2.588l2.348-7.288h-4.016l-3.328 12h6.624l2.184-7.288h4.516l-2.684-8.016h-3.544l-2.5 8.016h-3.568l-2.268 8.016h3.544l2.5-8.016h3.56l2.268-8.016h-3.544z"/>
              </svg>
              Twitter
            </a>
            <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://xxntti3n.github.io%2Fstreaming-processing-guide%2F" target="_blank" rel="noopener" class="share-btn">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
              </svg>
              LinkedIn
            </a>
            <a href="https://github.com/xxntti3n" target="_blank" rel="noopener" class="share-btn">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.236 3.221-1.236 4.608 0 2.807 1.803 5.626 5.469 5.921-.43.372-.823 1.102-.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
              </svg>
              GitHub
            </a>
          </div>
        </div>

        <!-- Author Bio -->
        <div class="author-bio">
          <h3>About the Author</h3>
          <p><strong>Tien Nguyen</strong> is a software engineer exploring distributed systems, cloud infrastructure, and developer tools. Writes about production learnings and technical deep dives across cloud-native platforms, container orchestration, and modern software development practices.</p>
        </div>

        <!-- Subscribe Box -->
        <div class="subscribe-box">
          <h3 class="subscribe-title">Enjoyed this article?</h3>
          <p class="subscribe-box-text">Subscribe to get weekly technical guides and engineering insights delivered to your inbox. No spam, just signal.</p>
          <form class="subscribe-form" id="subscribeForm">
            <input type="email" placeholder="your@email.com" required class="subscribe-input">
            <button type="submit" class="subscribe-btn">Subscribe</button>
          </form>
          <p class="subscribe-terms">By subscribing, you agree to receive emails. Unsubscribe anytime.</p>
        </div>
      </article>
    </main>

    <footer class="site-footer">
  <div class="footer-content">
    <p class="footer-text">&copy; 2026 xxntti3n. Built with <a href="https://jekyllrb.com/" style="color: inherit;">Jekyll</a> & <a href="https://pages.github.com/" style="color: inherit;">GitHub Pages</a>.</p>
    <div class="social-links">
      <a href="https://linkedin.com/in/xxntti3n" target="_blank" rel="noopener" aria-label="LinkedIn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
        </svg>
      </a>
      <a href="https://github.com/xxntti3n" target="_blank" rel="noopener" aria-label="GitHub">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.236 3.221-1.236 4.608 0 2.807 1.803 5.626 5.469 5.921-.43.372-.823 1.102-.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
      </a>
      <a href="/feed.xml" aria-label="RSS Feed">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19.43 7.39 20.4 6.18 20.4a2.18 2.18 0 0 1-2.18-2.18c0-1.21.97-2.18 2.18-2.18zM2 10.1a12 12 0 0 1 12 12 12 12 0 0 1 3.53-8.43 12 12 0 0 1-3.53-8.43H12A10 10 0 0 0 2 10.1zm0-5.9a17.9 17.9 0 0 1 17.9 17.9 17.9 17.9 0 0 1 5.27 12.69A17.9 17.9 0 0 1 12 22.07V20a16 16 0 0 0 4.71-11.34A16 16 0 0 0 12 2v2.1z"/>
        </svg>
      </a>
    </div>
  </div>
</footer>

<style>
  .site-footer {
    background: var(--bg-secondary);
    border-top: 1px solid var(--border);
    padding: 40px 0;
    margin-top: auto;
    transition: background-color 0.3s ease;
  }

  .dark-theme .site-footer {
    background: var(--bg-secondary);
    border-top-color: rgba(255, 255, 255, 0.1);
  }

  .footer-content {
    max-width: var(--max-width);
    margin: 0 auto;
    padding: 0 24px;
    text-align: center;
  }

  .footer-text {
    font-family: var(--font-sans);
    font-size: 13px;
    color: var(--text-tertiary);
    margin: 0;
  }

  .dark-theme .footer-text {
    color: #6e7681;
  }

  .social-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 16px;
  }

  .social-links a {
    color: var(--text-secondary);
    text-decoration: none;
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 8px;
    background: var(--bg-tertiary);
    transition: all 0.2s ease;
  }

  .dark-theme .social-links a {
    background: rgba(255, 255, 255, 0.05);
    color: #8b949e;
  }

  .social-links a:hover {
    color: var(--accent);
    transform: translateY(-2px);
  }

  .social-links a svg {
    width: 18px;
    height: 18px;
  }

  @media (max-width: 600px) {
    .social-links a {
      width: 36px;
      height: 36px;
    }

    .social-links a svg {
      width: 16px;
      height: 16px;
    }
  }
</style>

  </div>

  <button class="back-to-top" id="backToTop" aria-label="Back to top">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 19V5M5 12l7-7 7 7"/>
    </svg>
  </button>

  <script>
    // Progress bar
    const progressBar = document.getElementById('progressBar');
    const backToTop = document.getElementById('backToTop');

    window.addEventListener('scroll', function() {
      const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
      const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const progress = Math.min((scrollTop / scrollHeight) * 100, 100);
      progressBar.style.width = progress + '%';

      if (window.pageYOffset > 500) {
        backToTop.classList.add('visible');
      } else {
        backToTop.classList.remove('visible');
      }
    });

    backToTop.addEventListener('click', function() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Generate Table of Contents
    document.addEventListener('DOMContentLoaded', function() {
      const tocList = document.getElementById('tocList');
      const content = document.querySelector('.article-content');

      if (!tocList || !content) return;

      const headings = content.querySelectorAll('h2');
      let sectionNumber = 1;

      headings.forEach(function(heading) {
        // Add ID to heading if missing
        if (!heading.id) {
          const text = heading.textContent.trim();
          const baseId = text.toLowerCase().replace(/[^a-z0-9]+/g, '-');
          heading.id = baseId || 'section-' + sectionNumber;
        }

        // Create TOC item
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#' + heading.id;
        a.textContent = heading.textContent.trim();
        li.appendChild(a);
        tocList.appendChild(li);

        sectionNumber++;
      });

      // Active state on scroll
      const tocLinks = tocList.querySelectorAll('a');
      window.addEventListener('scroll', function() {
        let current = '';
        headings.forEach(function(heading) {
          const sectionTop = heading.offsetTop;
          if (window.pageYOffset >= sectionTop - 150) {
            current = heading.id;
          }
        });

        tocLinks.forEach(function(link) {
          link.classList.remove('active');
          if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
          }
        });
      });
    });

    // Subscribe form
    const subscribeForm = document.getElementById('subscribeForm');
    if (subscribeForm) {
      subscribeForm.addEventListener('submit', function(e) {
        e.preventDefault();
        alert('Thanks for subscribing!');
      });
    }
  </script>
</body>
</html>
